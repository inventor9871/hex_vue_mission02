import{r as p,o as D,c as i,a as t,t as _,w as r,b as $,v as O,n as m,F as U,d as E,e as y,f as c,u as F,g as d,h as P}from"./index-DYxxAW4b.js";const S={id:"todoListPage",class:"bg-half"},A={class:"todo_sm"},R={href:"#/todos"},j={class:"conatiner todoListPage vhContainer"},q={class:"todoList_Content"},G={class:"inputBox"},H={class:"todoList_list"},J={class:"todoList_tab"},K={class:"todoList_items"},Q={class:"todoList_item"},W={class:"todoList_label"},X=["onUpdate:modelValue","onChange"],Y=["onClick"],Z={class:"todoList_statistics"},tt={key:0},et={key:1},ot={key:0},st={key:1},at={key:2},v="https://todolist-api.hexschool.io",nt={__name:"TodosView",props:["nickname"],emits:["showLogin"],setup(C,{emit:w}){const h=p([]),s=p([]),u=document.cookie.replace(/(?:^|.*;\s*)todoName\s*=\s*([^;]*).*$/i,"$1"),f=async()=>{const o=await c.get(`${v}/todos/`,{headers:{authorization:u}});h.value=o.data.data,s.value=o.data.data,n.value=s.value.length},x=w;D(()=>{f()});const l=p(1),n=p(0),L=()=>{f(),l.value=1,s.value=h.value,n.value=s.value.length},b=()=>{l.value=2,s.value=h.value.filter(o=>o.status===!1),n.value=s.value.length},z=()=>{l.value=3,s.value=h.value.filter(o=>o.status===!0),n.value=s.value.length},g=p({content:""}),T=F(),V=async()=>{try{await c.post(`${v}/todos`,g.value,{headers:{authorization:u}}),g.value.content="",f(),L(),T.push("/todos")}catch(o){console.log("addTodo error, ",o)}},N=async o=>{try{await c.delete(`${v}/todos/${o}`,{headers:{authorization:u}});const e=s.value.findIndex(a=>a.id===o);s.value.splice(e,1),n.value=s.value.length,B(),alert("刪除成功")}catch(e){console.log("deltodo error , ",e)}},B=async()=>{const o=await c.get(`${v}/todos/`,{headers:{authorization:u}});h.value=o.data.data},I=async o=>{try{if(await c.patch(`${v}/todos/${o}/toggle`,null,{headers:{authorization:u}}),l.value!==1){const e=s.value.findIndex(a=>a.id===o);s.value.splice(e,1),n.value=s.value.length}}catch(e){console.log("checkTodo error，",e)}},M=async()=>{try{const o=await c.post(`${v}/users/sign_out`,{},{headers:{authorization:u}});alert(o.data.message),x("showLogin",[!0,!1,!1]),T.push("/")}catch(o){console.log("signout error, ",o)}};return(o,e)=>(d(),i("div",S,[t("nav",null,[e[4]||(e[4]=t("h1",null,[t("a",{href:"#/todos"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",A,[t("a",R,[t("span",null,_(C.nickname)+" 的代辦",1)])]),t("li",null,[t("a",{href:"#/todos",onClick:r(M,["prevent"])},"登出")])])]),t("div",j,[t("div",q,[t("div",G,[$(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=a=>g.value.content=a)},null,512),[[O,g.value.content]]),t("a",{href:"#",onClick:r(V,["prevent"])},e[5]||(e[5]=[t("i",{class:"fa fa-plus"},null,-1)]))]),t("div",H,[t("ul",J,[t("li",null,[t("a",{href:"#",class:m([l.value==1?"active":""]),onClick:e[1]||(e[1]=r(a=>L(),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:m([l.value==2?"active":""]),onClick:e[2]||(e[2]=r(a=>b(),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:m([l.value==3?"active":""]),onClick:e[3]||(e[3]=r(a=>z(),["prevent"]))},"已完成",2)])]),t("div",K,[t("ul",Q,[(d(!0),i(U,null,E(s.value,a=>(d(),i("li",{key:a.id},[t("label",W,[$(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":k=>a.status=k,onChange:k=>I(a.id)},null,40,X),[[P,a.status]]),t("span",null,_(a.content),1)]),t("a",{href:"#",onClick:r(k=>N(a.id),["prevent"])},e[6]||(e[6]=[t("i",{class:"fa fa-times"},null,-1)]),8,Y)]))),128))]),t("div",Z,[l.value==1?(d(),i("p",tt," 全部總共有 "+_(n.value)+" 個項目",1)):y("",!0),l.value==2?(d(),i("div",et,[n.value>0?(d(),i("p",ot," 尚未完成 "+_(n.value)+" 個項目",1)):(d(),i("p",st,"目前尚無待辦事項"))])):y("",!0),l.value==3?(d(),i("p",at," 已完成 "+_(n.value)+" 個項目",1)):y("",!0)])])])])])]))}};export{nt as default};
