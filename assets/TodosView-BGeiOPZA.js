import{r as p,o as I,c as i,a as t,t as _,w as r,b as $,v as M,n as y,F as D,d as O,e as m,f as c,u as U,g as d,h as E}from"./index-BwYJkb7Y.js";const F={id:"todoListPage",class:"bg-half"},P={class:"todo_sm"},S={href:"#/todos"},A={class:"conatiner todoListPage vhContainer"},R={class:"todoList_Content"},j={class:"inputBox"},q={class:"todoList_list"},G={class:"todoList_tab"},H={class:"todoList_items"},J={class:"todoList_item"},K={class:"todoList_label"},Q=["onUpdate:modelValue","onChange"],W=["onClick"],X={class:"todoList_statistics"},Y={key:0},Z={key:1},tt={key:0},et={key:1},ot={key:2},v="https://todolist-api.hexschool.io",at={__name:"TodosView",props:["nickname"],setup(C){const u=document.cookie.replace(/(?:^|.*;\s*)todoName\s*=\s*([^;]*).*$/i,"$1"),h=p([]),s=p([]),f=async()=>{const o=await c.get(`${v}/todos/`,{headers:{authorization:u}});h.value=o.data.data,s.value=o.data.data,n.value=s.value.length};I(()=>{f()});const l=p(1),n=p(0),L=()=>{f(),l.value=1,s.value=h.value,n.value=s.value.length},x=()=>{l.value=2,s.value=h.value.filter(o=>o.status===!1),n.value=s.value.length},w=()=>{l.value=3,s.value=h.value.filter(o=>o.status===!0),n.value=s.value.length},g=p({content:""}),T=U(),b=async()=>{try{await c.post(`${v}/todos`,g.value,{headers:{authorization:u}}),g.value.content="",f(),L(),T.push("/todos")}catch(o){console.log("addTodo error, ",o)}},z=async o=>{try{await c.delete(`${v}/todos/${o}`,{headers:{authorization:u}});const e=s.value.findIndex(a=>a.id===o);s.value.splice(e,1),n.value=s.value.length,V(),alert("刪除成功")}catch(e){console.log("deltodo error , ",e)}},V=async()=>{const o=await c.get(`${v}/todos/`,{headers:{authorization:u}});h.value=o.data.data},N=async o=>{try{if(await c.patch(`${v}/todos/${o}/toggle`,null,{headers:{authorization:u}}),l.value!==1){const e=s.value.findIndex(a=>a.id===o);s.value.splice(e,1),n.value=s.value.length}}catch(e){console.log("checkTodo error，",e)}},B=async()=>{try{const o=await c.post(`${v}/users/sign_out`,{},{headers:{authorization:u}});alert(o.data.message),T.push("/")}catch(o){console.log("signout error, ",o)}};return(o,e)=>(d(),i("div",F,[t("nav",null,[e[4]||(e[4]=t("h1",null,[t("a",{href:"#/todos"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",P,[t("a",S,[t("span",null,_(C.nickname)+" 的代辦",1)])]),t("li",null,[t("a",{href:"#/todos",onClick:r(B,["prevent"])},"登出")])])]),t("div",A,[t("div",R,[t("div",j,[$(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=a=>g.value.content=a)},null,512),[[M,g.value.content]]),t("a",{href:"#",onClick:r(b,["prevent"])},e[5]||(e[5]=[t("i",{class:"fa fa-plus"},null,-1)]))]),t("div",q,[t("ul",G,[t("li",null,[t("a",{href:"#",class:y([l.value==1?"active":""]),onClick:e[1]||(e[1]=r(a=>L(),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:y([l.value==2?"active":""]),onClick:e[2]||(e[2]=r(a=>x(),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:y([l.value==3?"active":""]),onClick:e[3]||(e[3]=r(a=>w(),["prevent"]))},"已完成",2)])]),t("div",H,[t("ul",J,[(d(!0),i(D,null,O(s.value,a=>(d(),i("li",{key:a.id},[t("label",K,[$(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":k=>a.status=k,onChange:k=>N(a.id)},null,40,Q),[[E,a.status]]),t("span",null,_(a.content),1)]),t("a",{href:"#",onClick:r(k=>z(a.id),["prevent"])},e[6]||(e[6]=[t("i",{class:"fa fa-times"},null,-1)]),8,W)]))),128))]),t("div",X,[l.value==1?(d(),i("p",Y," 全部總共有 "+_(n.value)+" 個項目",1)):m("",!0),l.value==2?(d(),i("div",Z,[n.value>0?(d(),i("p",tt," 尚未完成 "+_(n.value)+" 個項目",1)):(d(),i("p",et,"目前尚無待辦事項"))])):m("",!0),l.value==3?(d(),i("p",ot," 已完成 "+_(n.value)+" 個項目",1)):m("",!0)])])])])])]))}};export{at as default};
